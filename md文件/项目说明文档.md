# 农作物产量预测系统 - 项目文档

## 📁 文档说明

本目录包含项目的核心文档：

### 核心文档
- **system_design.md** - 系统设计文档
- **database-schema.sql** - 数据库结构定义

### 论文相关
- **开题报告恭浩杰.docx** - 开题报告
- **论文3稿.docx** - 论文文档
- **thesis_excerpt.txt** - 论文摘录

---

## 🎯 项目概述

**农作物产量预测与可视化分析平台** - 基于机器学习的智能农业管理系统

### 技术栈
- **后端**: Spring Boot 3.5 + JPA + MySQL + JWT + Spring Security
- **前端**: Vue 3 + Vite + Element Plus + ECharts + Pinia
- **预测引擎**: DL4J (LSTM) + ARIMA + Prophet

### 核心功能
1. 🔐 用户认证与权限管理（三种角色）
2. 📊 数据管理（产量、价格、天气数据）
3. 🤖 智能预测（LSTM、ARIMA、Prophet三种模型）
4. 📈 可视化分析（多维度图表展示）
5. 📄 报表生成（自动生成并导出PDF/Excel）
6. 💬 在线咨询（用户与技术人员沟通）
7. ⚙️ 系统管理（日志审计、系统设置）

---

## 🏗️ 项目结构

### 后端结构 (demo/)
```
demo/src/main/java/com/gxj/cropyield/
├── CropYieldApplication.java    # 启动类
├── common/                       # 公共基础设施
│   ├── audit/                   # 审计日志
│   ├── security/                # JWT认证
│   ├── exception/               # 异常处理
│   └── response/                # 统一响应
├── config/                       # 全局配置
│   ├── ApplicationSecurityConfig.java  # Spring Security
│   ├── AsyncConfig.java                # 异步任务
│   ├── CacheConfig.java                # 缓存配置
│   └── WebConfig.java                  # CORS配置
└── modules/                      # 业务模块
    ├── auth/                    # 认证授权
    ├── forecast/                # 预测引擎（核心）
    ├── report/                  # 报表管理
    ├── dataset/                 # 数据集管理
    ├── base/                    # 基础数据
    ├── consultation/            # 咨询服务
    ├── system/                  # 系统管理
    └── weather/                 # 天气数据
```

### 前端结构 (forecast/)
```
forecast/src/
├── main.js                      # 应用入口
├── router/                      # 路由配置
├── stores/                      # Pinia状态管理
├── services/                    # API服务层
├── views/                       # 页面视图
│   ├── LoginView.vue           # 登录页
│   ├── DashboardView.vue       # 仪表盘
│   ├── DataCenterView.vue      # 数据中心
│   ├── ForecastCenterView.vue  # 预测中心
│   ├── ReportCenterView.vue    # 报表中心
│   └── ...
└── components/                  # 可复用组件
    ├── visualization/          # 可视化组件（6个）
    ├── forecast/               # 预测组件（5个）
    ├── data/                   # 数据组件（4个）
    └── report/                 # 报表组件
```

---

## 🔄 三层架构

```
Controller 层 (表现层)
    ↓ 构造函数注入
Service 层 (业务层)
    ↓ 构造函数注入
Repository 层 (持久层)
    ↓ JPA/Hibernate
Database 层 (MySQL)
```

**连接方式**: Spring依赖注入（构造函数注入）

---

## 🔑 用户角色

| 角色 | 代码 | 权限 |
|-----|------|------|
| 系统管理员 | ADMIN | 全部功能 |
| 技术人员 | AGRICULTURE_DEPT | 数据分析、预测、报表、咨询回复 |
| 普通用户 | FARMER | 查看数据、发起咨询、查看报表 |

---

## 🚀 快速启动

### 后端启动
```bash
cd demo
./mvnw spring-boot:run
# 访问: http://localhost:8080
# 默认账号: admin / Admin@123
```

### 前端启动
```bash
cd forecast
npm install
npm run dev
# 访问: http://localhost:5173
```

---

## 📊 核心业务流程

### 1. 用户登录
```
输入用户名密码 → 后端验证 → 生成JWT令牌 → 前端存储 → 后续请求携带令牌
```

### 2. 预测任务
```
选择模型和参数 → 创建任务 → 异步执行预测 → 保存结果 → 前端展示图表
```

### 3. 报表生成
```
选择数据范围 → 生成报表 → 聚合数据 → 创建报表实体 → 导出PDF/Excel
```

---

## 🎨 技术亮点

### 后端优化
- ✅ 53个数据库性能索引
- ✅ Caffeine本地缓存（6个缓存区域）
- ✅ 异步任务处理（3个专用线程池）
- ✅ 审计日志系统（AOP切面）
- ✅ JWT自动刷新机制

### 前端优化
- ✅ 组件化设计（15个可复用组件）
- ✅ 路由权限守卫
- ✅ Axios请求/响应拦截器
- ✅ Pinia状态管理
- ✅ ECharts数据可视化

### 预测引擎
- ✅ LSTM深度学习模型
- ✅ ARIMA时间序列模型
- ✅ Prophet季节性预测
- ✅ 滞后特征工程
- ✅ 模型缓存复用

---

## 📚 数据库设计

详见 `database-schema.sql`

### 核心数据表
- `user` - 用户表
- `role` - 角色表
- `crop` - 作物表
- `region` - 地区表
- `yield_record` - 产量记录
- `forecast_task` - 预测任务
- `forecast_run` - 预测执行记录
- `report` - 报表
- `consultation` - 咨询
- `audit_log` - 审计日志

---

## 📝 开发规范

### 后端规范
- 使用三层架构（Controller-Service-Repository）
- 统一响应格式（ApiResponse）
- 全局异常处理（GlobalExceptionHandler）
- 事务管理（@Transactional）
- 审计日志（@AuditLog）

### 前端规范
- 组件化开发
- 统一API服务层
- Pinia状态管理
- 路由权限控制
- 统一错误提示

---

**项目状态**: ✅ 生产就绪  
**创建时间**: 2026-01-06  
**技术版本**: Spring Boot 3.5 + Vue 3 + MySQL 8
