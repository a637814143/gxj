# 四个预测模型算法简介

## 模型一：LSTM深度学习模型

### 使用的算法
**长短期记忆网络（Long Short-Term Memory, LSTM）**

### 算法类型
深度学习 / 循环神经网络（RNN）

### 核心原理
LSTM是一种特殊的循环神经网络，通过"门控机制"来记忆和遗忘信息：
- **遗忘门**：决定丢弃哪些旧信息
- **输入门**：决定存储哪些新信息
- **输出门**：决定输出什么信息

### 实现框架
**DeepLearning4J (DL4J)** - Java深度学习库

### 网络结构
```
输入层 → LSTM层(32个神经元) → 输出层
```

### 关键参数
- 隐藏层大小：32
- 学习率：0.001
- 优化器：Adam
- 训练轮数：20

### 适合场景
- 数据量充足（20+个数据点）
- 存在复杂的非线性关系
- 需要高精度预测

---

## 模型二：ARIMA时间序列模型

### 使用的算法
**自回归积分滑动平均模型（AutoRegressive Integrated Moving Average, ARIMA）**

### 算法类型
经典统计模型 / 时间序列分析

### 核心原理
ARIMA由三部分组成：
1. **AR（自回归）**：用过去的值预测未来
   - 公式：y_t = φ₁·y_{t-1} + φ₂·y_{t-2} + ... + ε_t
   
2. **I（差分）**：消除趋势，使数据平稳
   - 公式：∇y_t = y_t - y_{t-1}
   
3. **MA（移动平均）**：用过去的预测误差修正预测
   - 公式：y_t = θ₁·ε_{t-1} + θ₂·ε_{t-2} + ... + ε_t

### 实现方式
**自主实现** - 基于最小二乘法和Yule-Walker方程

### 模型参数 ARIMA(p, d, q)
- p = 1：使用过去1个值（AR阶数）
- d = 1：进行1次差分（差分阶数）
- q = 1：使用过去1个误差（MA阶数）

### 适合场景
- 数据呈现线性趋势
- 时间序列相对平稳
- 需要快速预测
- 需要模型可解释性

---

## 模型三：Prophet事件影响模型

### 使用的算法
**Prophet可加性模型**（Facebook开发）

### 算法类型
时间序列分解模型

### 核心原理
将时间序列分解为三个可加的组件：

**y(t) = g(t) + s(t) + h(t) + ε**

1. **g(t) - 趋势项**：
   - 使用分段线性函数或逻辑增长曲线
   - 自动检测趋势变化点
   
2. **s(t) - 季节性项**：
   - 使用傅里叶级数表示周期性
   - 公式：Σ[aₙ·cos(2πnt/P) + bₙ·sin(2πnt/P)]
   
3. **h(t) - 节假日效应**：
   - 特殊事件的影响（如极端天气）

### 实现方式
**简化版自主实现** - 基于线性回归和傅里叶变换

### 关键参数
- changepointPriorScale = 0.05：趋势变化灵活度
- seasonalityPriorScale = 10.0：季节性强度
- 自动检测季节周期

### 适合场景
- 数据具有明显季节性
- 存在趋势变化点
- 需要考虑特殊事件影响
- 需要可解释的预测结果

---

## 模型四：天气因子多元回归模型

### 使用的算法
**多元线性回归（Multiple Linear Regression）**

### 算法类型
经典统计模型 / 回归分析

### 核心原理
建立产量与气象因子之间的线性关系：

**Y = β₀ + β₁·X₁ + β₂·X₂ + ... + βₙ·Xₙ + ε**

其中：
- Y：农作物产量
- X₁, X₂, ..., Xₙ：气象因子（温度、降水、日照等）
- β₀, β₁, ..., βₙ：回归系数
- ε：随机误差

### 实现方式
**最小二乘法（OLS）** - 自主实现

**求解公式**：
```
β = (X^T X)^(-1) X^T Y
```

### 气象特征
- **温度**：平均温度、最高温度、最低温度、积温
- **降水**：总降水量、降水天数、降水分布
- **日照**：总日照时数、日照百分率
- **湿度**：平均相对湿度、饱和水汽压差

### 特征工程
- **标准化**：Z-score标准化消除量纲影响
- **趋势外推**：对未来气象因子进行线性预测
- **用户输入**：支持手动输入未来气象数据

### 适合场景
- 有完整的历史气象数据
- 需要理解气象因子的具体影响
- 需要进行情景分析（what-if分析）
- 需要向决策者解释预测依据

---

## 四个模型的算法对比

| 模型 | 算法类型 | 核心算法 | 实现方式 | 复杂度 |
|-----|---------|---------|---------|--------|
| **LSTM** | 深度学习 | 循环神经网络 + 门控机制 | DeepLearning4J | 高 |
| **ARIMA** | 统计模型 | 自回归 + 差分 + 移动平均 | 自主实现（最小二乘法） | 中 |
| **Prophet** | 分解模型 | 趋势分解 + 傅里叶级数 | 简化版自主实现 | 中 |
| **天气回归** | 回归模型 | 多元线性回归 | 自主实现（OLS） | 低 |

## 算法选择的数学基础

### LSTM的数学表达
```
遗忘门：f_t = σ(W_f·[h_{t-1}, x_t] + b_f)
输入门：i_t = σ(W_i·[h_{t-1}, x_t] + b_i)
输出门：o_t = σ(W_o·[h_{t-1}, x_t] + b_o)
细胞状态：C_t = f_t * C_{t-1} + i_t * tanh(W_C·[h_{t-1}, x_t] + b_C)
隐藏状态：h_t = o_t * tanh(C_t)
```

### ARIMA的数学表达
```
ARIMA(p,d,q)：
∇^d y_t = c + Σφᵢ·∇^d y_{t-i} + Σθⱼ·ε_{t-j} + ε_t
```

### Prophet的数学表达
```
y(t) = g(t) + s(t) + h(t) + ε
g(t) = (k + a(t)^T δ)·t + (m + a(t)^T γ)  # 趋势
s(t) = Σ[aₙ·cos(2πnt/P) + bₙ·sin(2πnt/P)]  # 季节性
```

### 天气回归的数学表达
```
Y = β₀ + Σβᵢ·Xᵢ + ε
β = (X^T X)^(-1) X^T Y  # 最小二乘解
```

---

## 总结

### 算法复杂度排序
1. **LSTM**：最复杂，需要训练神经网络
2. **Prophet**：中等，需要分解和拟合多个组件
3. **ARIMA**：中等，需要迭代求解参数
4. **天气回归**：最简单，直接矩阵运算

### 可解释性排序
1. **天气回归**：最强，每个系数都有明确含义
2. **Prophet**：强，可以看到趋势和季节性
3. **ARIMA**：中等，参数有统计意义
4. **LSTM**：最弱，黑盒模型

### 预测精度排序（一般情况）
1. **LSTM**：最高（数据充足时）
2. **天气回归**：高（有气象数据时）
3. **Prophet**：中高（有季节性时）
4. **ARIMA**：中等（数据平稳时）

### 实际应用建议
- **科研场景**：优先LSTM（追求精度）
- **业务场景**：优先天气回归（可解释性）
- **快速预测**：优先ARIMA（计算快）
- **长期趋势**：优先Prophet（趋势分析）

